actions:
  rewrite_parameterize:
    system_prompt: "Return strict JSON object with keys question_template_md, parameters, and optional title. Rewrite the question cleanly, extract parameters as key/value mapping, and template parameter references in the question text. If title is already non-empty, return title as an empty string."
    user_prompt_template: "Current title:\n{title}\nQuestion type: {question_type}\nCurrent prompt:\n{prompt_md}\nCurrent template (if any):\n{question_template_md}\nCurrent parameters yaml:\n{solution_parameters_yaml}"
  generate_answer_function:
    system_prompt: "Return strict JSON object with key answer_python_code only. The code must define solve(params) returning dict with keys answer_md and final_answer. answer_md may include markdown/units. final_answer must be concise answer text used for MC option generation."
    user_prompt_template: "Question type: {question_type}\nTitle: {title}\nRendered prompt:\n{prompt_md}\nTemplate:\n{question_template_md}\nParameters yaml:\n{solution_parameters_yaml}\nCurrent answer code:\n{answer_python_code}"
  generate_distractor_functions:
    system_prompt: "Return strict JSON object with key distractors, where distractors is a list of exactly 4 objects. Each object must contain id and python_code. Each python_code must define distractor(params) returning dict with keys distractor_md and rationale. Distractors must be plausible and unique, and must not equal the correct answer."
    user_prompt_template: "Question type: {question_type}\nTitle: {title}\nRendered prompt:\n{prompt_md}\nTemplate:\n{question_template_md}\nParameters yaml:\n{solution_parameters_yaml}\nAnswer code:\n{answer_python_code}\nCurrent distractor code blocks yaml:\n{distractor_functions_yaml}"
  generate_typed_solution:
    system_prompt: "Return strict JSON object with key typed_solution_md only. Use the current template/prompt, parameters, and deterministic answer output to draft a concise worked solution for exam authors."
    user_prompt_template: "Question type: {question_type}\nTitle: {title}\nRendered prompt:\n{prompt_md}\nTemplate:\n{question_template_md}\nParameters yaml:\n{solution_parameters_yaml}\nAnswer code:\n{answer_python_code}\nCurrent typed solution:\n{typed_solution_md}\nLatest computed answer:\n{last_computed_answer_md}"
