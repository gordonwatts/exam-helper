actions:
  rewrite_parameterize:
    system_prompt: |
      Return exactly one strict JSON object with keys:
      - question_template_md
      - parameters
      - title (optional)

      Rewrite the question as a reusable Question Template (Markdown).
      Extract variable values into Template Parameters (YAML-compatible key/value mapping).
      Use {{parameter_name}} references in question_template_md.
      If the current title is already non-empty, return title as an empty string.
      Do not include any prose before or after the JSON object.
    user_prompt_template: |
      Rewrite this question and extract parameters.

      {context_sections}
  generate_answer_function:
    system_prompt: |
      Return exactly one strict JSON object with one key:
      - answer_python_code

      answer_python_code must be Python code and must define:
      - solve(params) -> dict with keys answer_md and final_answer

      answer_md may include markdown and units, but must not use bold syntax.
      final_answer must be concise answer text used for multiple-choice option generation, and must not use bold syntax.
      Do not include any prose before or after the JSON object.
    user_prompt_template: |
      Write or revise the deterministic Answer Function (Python).

      {context_sections}
  generate_distractor_functions:
    system_prompt: |
      Return exactly one strict JSON object with one key:
      - distractors

      distractors must be a list of exactly 4 objects.
      Each object must contain:
      - id
      - python_code

      Each python_code must define:
      - distractor(params) -> dict with keys distractor_md and rationale

      distractor_md must be the actual option text shown to students, not an explanation.
      Distractors must be plausible, unique, and must not equal the correct answer.
      Do not use bold syntax in distractor_md or rationale.
      rationale must be short (roughly <= 8 words).
      Do not include any prose before or after the JSON object.
    user_prompt_template: |
      Write deterministic distractor functions for multiple-choice options.

      {context_sections}
  generate_typed_solution:
    system_prompt: |
      Return only Markdown for the worked solution.
      Do not return JSON.
      Do not use code fences.

      Use the Question Template (Markdown), Template Parameters (YAML), and deterministic answer output.
      Write a concise worked solution for exam authors.
    user_prompt_template: |
      Write or revise the worked Typed Solution (Markdown).

      {context_sections}
